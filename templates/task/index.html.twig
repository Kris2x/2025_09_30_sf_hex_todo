{% extends 'base.html.twig' %}

{% block title %}Task List - TODO App{% endblock %}

{% block styles %}
.task-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.task-list {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    overflow: hidden;
}

.task-item {
    padding: 1.5rem;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color 0.2s ease;
}

.task-item:last-child {
    border-bottom: none;
}

.task-item:hover {
    background-color: #f8f9fa;
}

.task-item.completed {
    opacity: 0.7;
}

.task-info {
    flex: 1;
}

.task-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: #2c3e50;
}

.task-title.completed {
    text-decoration: line-through;
    color: #6c757d;
}

.task-description {
    color: #6c757d;
    margin-bottom: 0.5rem;
}

.task-meta {
    display: flex;
    gap: 1rem;
    font-size: 0.875rem;
    color: #6c757d;
}

.task-status {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
}

.task-status.pending {
    background-color: #fff3cd;
    color: #856404;
}

.task-status.completed {
    background-color: #d4edda;
    color: #155724;
}

.task-actions {
    display: flex;
    gap: 0.5rem;
}

.task-actions form {
    display: inline;
}

.empty-state {
    padding: 3rem;
    text-align: center;
    color: #6c757d;
}

.empty-state h2 {
    font-size: 1.5rem;
    margin-bottom: 1rem;
}
{% endblock %}

{% block content %}
<div class="task-header">
    <h2>Your Tasks</h2>
    <a href="{{ path('task_create') }}" class="btn btn-primary">+ New Task</a>
</div>

{% if tasks|length > 0 %}
<div class="task-list">
    {% for task in tasks %}
    <div class="task-item {% if task.completed %}completed{% endif %}">
        <div class="task-info">
            <div class="task-title {% if task.completed %}completed{% endif %}">
                {{ task.title }}
            </div>
            <div class="task-description">
                {{ task.description }}
            </div>
            <div class="task-meta">
                <span class="task-status {% if task.completed %}completed{% else %}pending{% endif %}">
                    {% if task.completed %}Completed{% else %}Pending{% endif %}
                </span>
                <span>Created: {{ task.createdAt|date('Y-m-d H:i') }}</span>
                {% if task.completedAt %}
                    <span>Completed: {{ task.completedAt|date('Y-m-d H:i') }}</span>
                {% endif %}
                {% if task.assignee %}
                    <span>Assigned to: {{ task.assignee.firstName }} {{ task.assignee.lastName }}</span>
                {% endif %}
                {% if task.createdBy %}
                    <span>Created by: {{ task.createdBy.firstName }} {{ task.createdBy.lastName }}</span>
                {% endif %}
            </div>
        </div>
        <div class="task-actions">
            {% if not task.completed %}
            <form method="POST" action="{{ path('task_complete', {id: task.id}) }}">
                <button type="submit" class="btn btn-success btn-small">Complete</button>
            </form>
            {% endif %}
            {% if is_granted('ROLE_ADMIN') %}
            <a href="{{ path('task_assign', {id: task.id}) }}" class="btn btn-primary btn-small">Assign</a>
            {% endif %}
            <form method="POST" action="{{ path('task_delete', {id: task.id}) }}" onsubmit="return confirm('Are you sure you want to delete this task?');">
                <button type="submit" class="btn btn-danger btn-small">Delete</button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="task-list">
    <div class="empty-state">
        <h2>No tasks yet!</h2>
        <p>Create your first task to get started.</p>
    </div>
</div>
{% endif %}
{% endblock %}
